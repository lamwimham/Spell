# PlayScreen 功能优化说明

## 优化内容

### 1. 播放状态管理优化

- **进度同步**: 改进了播放进度与实际音频状态的同步机制
- **播放完成处理**: 添加了播放完成后的自动处理逻辑
- **循环播放支持**: 实现了完整的循环播放功能

### 2. 控制按钮优化

- **左侧按钮**:
  - 单次播放模式下显示固定"1 次"文本
  - 循环播放模式下显示可调节的循环次数控制器
- **中间按钮**: 保持原有的播放/暂停控制功能
- **右侧按钮**:
  - 添加了循环模式切换按钮
  - 使用"infinite"图标表示循环播放
  - 使用"arrow-forward"图标表示单次播放

### 3. 循环播放功能

- **模式切换**: 支持在单次播放和循环播放之间切换
- **循环次数设置**:
  - 循环模式下可调整循环次数(1-99 次)
  - 提供增加和减少按钮
  - 限制最大 99 次和最小 1 次
- **状态显示**: 显示当前循环进度(如: 2/5)

## 功能特性

### 播放状态管理

```typescript
// 循环播放完成处理
const handlePlaybackComplete = async () => {
  if (isLooping) {
    // 循环播放逻辑
    const newLoop = currentLoop + 1;
    if (newLoop < loopCount) {
      // 重新开始播放
    } else {
      // 循环完成，停止播放
    }
  } else {
    // 单次播放完成，停止播放
  }
};
```

### 控制按钮布局

```
[循环次数] [停止] [播放/暂停] [循环模式]
   3次      ■      ▶/⏸       ∞
```

### 循环控制

- **切换模式**: 点击右侧循环按钮在单次/循环模式间切换
- **调整次数**: 循环模式下使用 +/- 按钮调整循环次数
- **状态显示**: 实时显示当前循环进度

## 使用方式

1. **基本播放**:

   - 点击中间播放按钮开始播放
   - 播放完成后自动停止(单次模式)

2. **循环播放**:

   - 点击右侧循环按钮切换到循环模式
   - 使用左侧 +/- 按钮调整循环次数
   - 播放将按设定次数循环播放

3. **状态查看**:
   - 循环模式下显示当前循环进度
   - 播放次数自动统计并显示

## 用户体验优化

- **直观的视觉反馈**: 不同模式使用不同图标和颜色
- **操作限制**: 在边界条件下禁用相应按钮
- **实时状态**: 循环进度和播放状态实时更新
- **错误处理**: 完善的错误提示和边界情况处理
